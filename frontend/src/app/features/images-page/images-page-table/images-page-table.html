<p-confirmpopup></p-confirmpopup>
<p-table
  #dt2
  [globalFilterFields]="['id', 'repository', 'tags']"
  dataKey="id"
  sortField="created"
  [sortOrder]="-1"
  [scrollable]="true"
  scrollHeight="flex"
  [value]="list()"
>
  <ng-template #header>
    <tr>
      <th>
        <p-iconfield iconPosition="left">
          <p-inputicon>
            <i class="pi pi-search"></i>
          </p-inputicon>
          <input
            #searchInput
            id="images-search"
            pInputText
            type="text"
            (input)="dt2.filterGlobal($event.target.value, 'contains')"
            [placeholder]="'IMAGES.TABLE.SEARCH_PLACEHOLDER' | translate"
          />
        </p-iconfield>
      </th>
      <th colspan="3"></th>
      <th>
        <p-buttongroup>
          <p-button
            [loading]="isLoading()"
            [label]="'GENERAL.REFRESH' | translate"
            icon="pi pi-refresh"
            (onClick)="updateList()"
          ></p-button>
          <p-button
            [loading]="isLoading()"
            severity="warn"
            [label]="'IMAGES.TABLE.PRUNE' | translate"
            icon="pi pi-eraser"
            (onClick)="confirmPrune($event)"
          >
          </p-button>
        </p-buttongroup>
      </th>
    </tr>

    <tr>
      <th pSortableColumn="id">
        {{ 'IMAGES.TABLE.ID' | translate }}
        <p-sortIcon field="id"></p-sortIcon>
      </th>
      <th pSortableColumn="repository">
        {{ 'IMAGES.TABLE.REPOSITORY' | translate }}
        <p-sortIcon field="repository"></p-sortIcon>
      </th>
      <th pSortableColumn="tags">
        {{ 'IMAGES.TABLE.TAGS' | translate }}
        <p-sortIcon field="tags"></p-sortIcon>
      </th>
      <th pSortableColumn="size">
        {{ 'IMAGES.TABLE.SIZE' | translate }}
        <p-sortIcon field="size"></p-sortIcon>
      </th>
      <th pSortableColumn="created">
        {{ 'IMAGES.TABLE.CREATED' | translate }}
        <p-sortIcon field="created"></p-sortIcon>
      </th>
    </tr>
  </ng-template>

  <ng-template
    #body
    let-image
  >
    <tr>
      <td>
        <div
          class="image-id"
          [pTooltip]="image.id"
        >
          {{ image.id }}
        </div>
        @if (image.dangling) {
          <p-tag severity="warn">
            {{ 'IMAGES.TABLE.DANGLING' | translate }}
          </p-tag>
        }
        @if (image.unused) {
          <p-tag severity="danger">
            {{ 'IMAGES.TABLE.UNUSED' | translate }}
          </p-tag>
        }
      </td>
      <td>
        <span>
          {{ image.repository }}
        </span>
      </td>
      <td>
        @for (t of image.tags; track t) {
          <p-tag
            [value]="t"
            severity="info"
          ></p-tag>
        }
      </td>
      <td>
        {{ image.size / 1024 / 1024 | number: '1.0-2' }}
        {{ 'IMAGES.TABLE.SIZE_UNIT' | translate }}
      </td>
      <td>
        {{ image.created | date: 'medium' }}
      </td>
    </tr>
  </ng-template>
</p-table>
